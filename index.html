<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ChatAI Bob PRO 2025</title>
<style>
body {
  background:#0b1220;
  font-family: Arial, sans-serif;
  color:#fff;
  display:flex;
  justify-content:center;
}
.box {
  max-width:420px;
  width:100%;
  padding:20px;
}
textarea, select, button, input {
  width:100%;
  margin:8px 0;
  padding:12px;
  border-radius:10px;
  border:none;
}
button {
  background:#1da1ff;
  color:#fff;
  font-size:16px;
}
.out {
  background:#111a2e;
  padding:15px;
  border-radius:10px;
  min-height:80px;
}
img, video {
  width:100%;
  border-radius:10px;
  margin-top:10px;
}
</style>
</head>

<body>
<div class="box">

<h2>ðŸ¤– ChatAI Bob PRO 2025</h2>

<textarea id="msg" rows="4" placeholder="Scrivi o usa il microfono..."></textarea>

<select id="mode">
  <option>Chat AI</option>
  <option>Immagine</option>
  <option>Video</option>
  <option>Analisi Foto</option>
</select>

<select id="lang">
  <option value="it">Italiano</option>
  <option value="en">English</option>
</select>

<button onclick="microfono()">ðŸŽ¤ Microfono</button>
<button onclick="invia()">ðŸš€ Invia</button>
<button onclick="pulisci()">ðŸ§¹ Pulisci</button>

<input type="file" id="foto" accept="image/*">

<div class="out" id="out">Pronto.</div>
<img id="img">
<video id="vid" controls></video>

<button onclick="leggi()">ðŸ”Š Leggi</button>

</div>

<script>
const GROQ_PROXY_URL = "https://shy-poetry-9c52.bouabidmoukhlis.workers.dev";

/* ---------- CHAT / IMMAGINE / VIDEO ---------- */
async function invia(){
  const msg = document.getElementById("msg").value;
  const mode = document.getElementById("mode").value;
  document.getElementById("out").innerText = "â³ Attendi...";

  if(mode === "Immagine"){
    document.getElementById("img").src =
      "https://image.pollinations.ai/prompt/" + encodeURIComponent(msg);
    return;
  }

  if(mode === "Video"){
    document.getElementById("vid").src =
      "https://image.pollinations.ai/prompt/" + encodeURIComponent(msg) + "?animate=true";
    return;
  }

  if(mode === "Analisi Foto"){
    const f = document.getElementById("foto").files[0];
    if(!f){ alert("Seleziona una foto"); return; }
    document.getElementById("out").innerText =
      "Analisi foto: " + f.name + " (demo descrizione AI)";
    return;
  }

  const r = await fetch(GROQ_PROXY_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      model:"llama-3.3-70b-versatile",
      messages:[{role:"user",content:msg}]
    })
  });

  const t = await r.text();
  document.getElementById("out").innerText = t;
}

/* ---------- MICROFONO ---------- */
function microfono(){
  const rec = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
  rec.lang = "it-IT";
  rec.onresult = e => {
    document.getElementById("msg").value = e.results[0][0].transcript;
  };
  rec.start();
}

/* ---------- VOCE ---------- */
function leggi(){
  const t = document.getElementById("out").innerText;
  const u = new SpeechSynthesisUtterance(t);
  u.lang = "it-IT";
  speechSynthesis.speak(u);
}

function pulisci(){
  msg.value="";
  out.innerText="";
  img.src="";
  vid.src="";
}
</script>

</body>
</html>
