<!DOCTYPE html>
<html lang="it">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ChatAI Bob PRO 2026</title>

<style>
body{font-family:system-ui;background:#f4f6f8;margin:0;padding:12px}
h2{text-align:center}
input,select,textarea,button{
  width:100%;max-width:600px;margin:8px auto;display:block;font-size:16px
}
textarea{height:90px;padding:10px}
button{padding:12px;background:#007bff;color:#fff;border:0;border-radius:6px}
#imgResult,#output{
  max-width:600px;margin:12px auto;padding:10px;background:#fff;border-radius:6px
}
footer{text-align:center;opacity:.6;margin-top:30px}
</style>
</head>

<body>

<h2>ğŸ‡²ğŸ‡¦ ChatAI Bob PRO 2026</h2>

<input type="file" id="imgInput" accept="image/*">
<button id="imgBtn">ğŸ–¼ï¸ Analizza foto</button>
<div id="imgResult">ğŸ“· Nessuna immagine analizzata.</div>

<textarea id="userText" placeholder="Scrivi come vuoiâ€¦"></textarea>
<button id="sendBtn">ğŸš€ Invia</button>
<div id="output">â³ Pronto.</div>

<footer>Â© 2025 ChatAI Bob PRO</footer>

<script>
const GROQ_PROXY_URL="https://groq-proxy-worker.bouabidmoukhlis.workers.dev";

document.getElementById("imgBtn").onclick=analyzeImage;
document.getElementById("sendBtn").onclick=sendMessage;

async function analyzeImage(){
  const input=document.getElementById("imgInput");
  const out=document.getElementById("imgResult");

  if(!input.files || !input.files[0]){
    out.textContent="âŒ Nessun file selezionato.";
    return;
  }

  out.textContent="â³ Analisi in corsoâ€¦";

  try{
    const base64=await toBase64(input.files[0]);

    const r=await fetch(GROQ_PROXY_URL,{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body:JSON.stringify({
        model:"llama-3.2-90b-vision-preview",
        messages:[{
          role:"user",
          content:[
            {type:"text",text:"Descrivi questa immagine"},
            {type:"image_url",image_url:{url:base64}}
          ]
        }],
        max_tokens:300
      })
    });

    const d=await r.json();
    out.textContent=d?.choices?.[0]?.message?.content || "âŒ Nessuna risposta";

  }catch(e){
    out.textContent="âŒ Errore: "+e.message;
  }
}

function toBase64(file){
  return new Promise((ok,err)=>{
    const r=new FileReader();
    r.onload=()=>ok(r.result);
    r.onerror=err;
    r.readAsDataURL(file);
  });
}

async function sendMessage(){
  const text=document.getElementById("userText").value.trim();
  const out=document.getElementById("output");
  if(!text){out.textContent="âš ï¸ Scrivi qualcosa.";return;}

  out.textContent="â³ Attendiâ€¦";

  const r=await fetch(GROQ_PROXY_URL,{
    method:"POST",
    headers:{"Content-Type":"application/json"},
    body:JSON.stringify({
      model:"llama-3.3-70b-versatile",
      messages:[{role:"user",content:text}],
      max_tokens:600
    })
  });

  const d=await r.json();
  out.textContent=d?.choices?.[0]?.message?.content || "âŒ Nessuna risposta";
}
</script>

</body>
</html>
