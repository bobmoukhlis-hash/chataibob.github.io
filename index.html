<script>
  const GROQ_PROXY_URL = "https://shy-poetry-9c52.bouabidmoukhlis.workers.dev";

  // âœ… Auto-detect: lingua browser (es: "ar", "fr", "it", "en")
  function detectLang() {<h2>ğŸ‡²ğŸ‡¦ ChatAI Bob PRO 2026 â€” Global</h2>
<select id="langMode">
  <option value="auto" selected>AUTO</option>
  <option value="ar">Arabic</option>
  <option value="ary">Darija (MA)</option>
  <option value="fr">FranÃ§ais</option>
  <option value="it">Italiano</option>
  <option value="en">English</option>
</select><!-- ğŸ” HEADER PRINCIPALE -->
<div style="text-align:center;margin-bottom:15px;">
  <h2 style="margin:0;">
    ğŸ‡²ğŸ‡¦ ChatAI Bob PRO 2026 â€” Global
  </h2>

  <div style="margin-top:8px;">
    <select id="langMode"
      style="padding:6px 10px;border-radius:8px;">
      <option value="auto" selected>ğŸŒ AUTO</option>
      <option value="ar">ğŸ‡¸ğŸ‡¦ Arabic</option>
      <option value="ary">ğŸ‡²ğŸ‡¦ Darija (MA)</option>
      <option value="fr">ğŸ‡«ğŸ‡· FranÃ§ais</option>
      <option value="it">ğŸ‡®ğŸ‡¹ Italiano</option>
      <option value="en">ğŸ‡¬ğŸ‡§ English</option>
    </select>
  </div>
</div><textarea></textarea>
<input type="file" />
<button>Invia</button>
    const l = (navigator.language || "en").toLowerCase();
    // normalizza: ar-* => ar, fr-* => fr...
    return l.split("-")[0];
  }

  // âœ… Rileva se sembra arabo/darija (semplice ma efficace)
  function looksArabic(text) {
    return /[\u0600-\u06FF]/.test(text); // range Unicode arabo
  }

  // âœ… Prompt â€œpotenteâ€ per lingua/dialetto
  function systemInstruction(userText) {
    const lang = detectLang();
    const arabic = looksArabic(userText);

    // regole: se scrive in arabo â†’ rispondi in arabo. Se darija â†’ darija.
    // Se non arabo â†’ lingua browser (o lingua del testo).
    return `
You are ChatAI Bob PRO 2026 (ğŸ‡²ğŸ‡¦).
Rules:
- Reply in the SAME language as the user message.
- If the user writes in Arabic script, reply in Arabic.
- If the user uses Moroccan Darija (words like: "Ø´Ù†Ùˆ", "ÙˆØ§Ø´", "Ø¨Ø²Ø§Ù", "Ø¯Ø§Ø¨Ø§", "ÙÙŠÙ†", "Ø¹Ø§ÙØ§Ùƒ"), reply in Moroccan Darija (Latin or Arabic script matching the user).
- If user writes Modern Standard Arabic, reply in ÙØµØ­Ù‰.
- Be short, practical, professional. No questions unless necessary.
- If the user mixes languages, follow the dominant language.
User language hint: ${arabic ? "Arabic" : lang}
`.trim();
  }

  async function groqChatAuto(userText) {
    const messages = [
      { role: "system", content: systemInstruction(userText) },
      { role: "user", content: userText }
    ];

    const res = await fetch(GROQ_PROXY_URL, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({
        model: "llama-3.3-70b-versatile",
        messages,
        temperature: 0.6,
        max_tokens: 600
      })
    });

    const data = await res.json();
    return data.text || data.choices?.[0]?.message?.content || JSON.stringify(data);
  }
</script>
